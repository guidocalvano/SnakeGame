<!DOCTYPE html>  
<!-- 
-->
<html lang="en">  
  <head>  
    <meta charset="utf-8">  
    <title> Firewall Snake Game </title>  
    <script src="/raphael.js"></script>
    <script src="/jquery.js"></script>
    <script src="/socket.io.js"></script>
    <script src="/BrowserScreen.js"></script>

    <script type="text/javascript" >
       $( document ).ready( function() 
		{
         console.log( 'DOC READY' ) ;
         
         var browserScreen = new BrowserScreen() ;
         
         var socket = io.connect('http://localhost:8126' ) ;
        /*
         
         */
        
         socket.on( 'ready', function()
                {
                 console.log( 'READY' ) ;

                 socket.emit( 'createSnake', '' ) ;

                 socket.on( 'queuePosition', function( position )
                    {
                     $( 'body' ).html( 'players before you ' + position ) ;
                    } ) ;


                 socket.on( 'gameOver', function()
                    {
                     $( document ).unbind( 'keypress' )  ;
                    } ) ;
                
                
                  socket.on( 'disconnect', function()
                    {
                     $( 'body' ).html( 'connection lost' ) ;
                    } ) ;
                    
                    
                 socket.on( 'snakeCreated', function()
                    {
                     console.log( 'SNAKE CREATED' ) ;
                     
                     $( 'body' ).html( 'click in the window and use the arrow keys to control the snake' ) ;

                     browserScreen.init( 20, 22, 17 ) ;
                     
                     socket.on( 'BrowserScreen.setColor', function( arg )
                        {
                         console.log( JSON.stringify( arg ) ) ;
                         browserScreen.setColor( arg.x, arg.y, arg.color ) ;
                        } ) ;

                     $( document ).keypress( function( event ) 
                            {
                             switch( event.charCode + event.keyCode  )
                                {
                                 case 38 : // up
                                 
                                    console.log( 'up' ) ;

                                    socket.emit( 'snakeCommand', 'down' ) ;
                                
                                    break ;
                                    
                                 case 40 : // down

                                    socket.emit( 'snakeCommand', 'up' ) ;
                                                 
                                    console.log( 'down' ) ;

                                    break ;
                                    
                                 case 37 : // left
                                 
                                    socket.emit( 'snakeCommand', 'left' ) ;
                                         
                                    console.log( 'left' ) ;

                                    break ;
                                                        
                                 case 39 : // right
                                 
                                    socket.emit( 'snakeCommand', 'right' ) ;
                                    
                                    console.log( 'right' ) ;
                                                     
                                                                                       
                                    break ;

                                
                                } ;
                            } ) ;
                        } ) ;
                } ) ;
                
                
            } ) ;
          
           
    

    </script>

  </head>  
  <body>  
  </body>  
</html>  